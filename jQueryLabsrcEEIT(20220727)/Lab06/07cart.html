<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>07cart.html</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <style>
        .wrapper {
            max-width: 640px;
            margin: 40px auto;
        }

        .text-right {
            text-align: right;
        }
    </style>
</head>

<body>
    <div class="wrapper">
        <table class="table table-bordered">
            <thead>
                <tr>
                    <th>品名</th>
                    <th>單價</th>
                    <th width="200px">數量</th>
                    <th>金額</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>蘋果</td>
                    <td class="price">35</td>
                    <td>
                        <input type="number" class="form-control number" value="3">
                    </td>
                    <td class="text-right">
                        <span class="s_price"></span>
                    </td>
                </tr>
                <tr>
                    <td>柳丁</td>
                    <td class="price">20</td>
                    <td>
                        <input type="number" class="form-control number" value="5">
                    </td>
                    <td class="text-right">
                        <span class="s_price"></span>
                    </td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td colspan="4" class="text-right">
                        總價:
                        <span id="total">0</span>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>
        $(".number").on("change keyup", function () {
            let ProductTr = $(this).closest("tr"); // 找到該列頂端，從該列頂往下找
            let qty = $(this).val(); // 數量
            let price = ProductTr.find(".price").text(); // 單價
            let s_price = qty * price; // 小計
            // console.log(qty, price, s_price);
            ProductTr.find(".s_price").text(s_price); // 小計寫入表格

            let total = 0; // 預設總價為0
            // each 迴圈，以選擇器 selector 來執行 $(".s_price") 選擇都是小計的欄位來加總
            $(".s_price").each(function () {
                total += Number($(this).text()); // 加總小計的金額(用 each)，this 為當前的欄位
                // console.log(total)
                $("#total").text(total); // 總價寫入表格
            })


        });
    </script>
</body>

</html>